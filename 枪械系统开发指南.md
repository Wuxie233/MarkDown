



# 无邪枪械系统开发手册
---
### 武器相关
#### 计分板名字与其对应用途

- 装备属性1 武器伤害
`影响子弹白值伤害`
- 装备属性2 武器穿透
`影响破甲线 详见*[破甲机制] `
- 装备属性3 武器射程
`影响子弹最远飞行距离`
- 装备属性4 武器速度
`影响子弹飞行速度`
- 装备属性5 武器后坐x
`影响子弹射出时水平偏移角度`
- 装备属性6 武器后坐y
`影响子弹射出时垂直偏移角度`
- 装备属性7 武器火焰
`影响武器开火粒子`
- 装备属性8 武器音效
`影响武器开火音效`
- 装备属性9 武器子弹
`影响武器射击消耗的子弹类型`
- 装备属性10 武器粒子
`影响子弹飞行时的轨迹粒子`
- 装备属性11 武器换弹
`影响武器重新填装弹匣的所需时间`
- 装备属性12 武器重量
`影响武器装备时的重量 详见*[负重机制]`
- 装备属性13 武器配件
`影响武器可支持的配件槽位（二进制）`
- 装备属性14 武器连射
`影响单次开火连续射击次数 详见*[子弹射击]`
- 装备属性15 武器弹片
`影响单次开火射出的子弹数量 详见*[子弹射击]`
- 装备属性16 武器间隔
`影响武器两次开火之间的间隔 详见*[子弹射击]`
- 装备属性17 武器弹匣
`影响武器弹匣可填充子弹的最多数量`
- 装备属性18 武器类型
`影响武器射击时的参数 随着枪械系统更新后续将支持更多枪械类型`
| 武器类型的计分板数值 |对应枪械类型       |
| ------- | ----- |
|    0    | 通用|
|    1    | 霰弹枪|
|    2    | 狙击枪|
> 明明可以通过计分板数值
>  武器连射=1,武器弹片=n(n≥2) 判定为 霰弹枪
>  武器连射=1,武器弹片=1 判定为 狙击枪
>  为什么还要多一个武器类型的参数呢？
> 因为以后可能会加入可以改变子弹连射和子弹弹片数量的拓展包 

---
### 防具相关
#### 计分板名字与其对应用途**

- 装备属性1 防具防御
`影响玩家防御力属性 详见*[破甲机制]`
- 装备属性2 防具免伤
`影响受击比例 详见*[子弹射击]`
- 装备属性3 防具负重
`影响玩家携带重量上限 详见*[负重机制]`
- 装备属性4 防具重量
`影响防具装备时的重量 详见*[负重机制]`

---
### 枪口相关
**计分板名字与其对应用途**
- 装备属性1     枪口射程
`影响子弹最远飞行距离`
- 装备属性2 枪口稳定x
`影响子弹射出时水平偏移角度`
- 装备属性3 枪口稳定y
`影响子弹射出时垂直偏移角度`
- 装备属性4 枪口消焰
`影响武器开火粒子 此值≥1时不触发武器开火相关粒子`
- 装备属性5 枪口消音
`影响武器开火声音 此值≥1时不触发武器开火相关音效`
- 装备属性6 枪口重量
`影响枪口装备时的重量 详见*[负重机制]`

---
### 握把相关
**计分板名字与其对应用途**
- 装备属性1 握把稳定x
`影响子弹射出时水平偏移角度`
- 装备属性2 握把稳定y
`影响子弹射出时垂直偏移角度`
- 装备属性3 握把重量
`影响握把装备时的重量 详见*[负重机制]`

---
### 弹匣相关
**计分板名字与其对应用途**
- 装备属性1 弹匣扩容
`影响武器弹匣可填充子弹的最多数量 扩充弹匣最高填充子弹数`
- 装备属性2 弹匣缩减
`影响武器重新填装弹匣的所需时间`
- 装备属性3 弹匣重量
`影响弹匣装备时的重量 详见*[负重机制]`

---
### 枪托相关
**计分板名字与其对应用途**
- 装备属性1 枪托稳定x
`影响子弹射出时水平偏移角度`
- 装备属性2 枪托稳定y
`影响子弹射出时垂直偏移角度`
- 装备属性3 枪托重量
`影响枪托装备时的重量 详见*[负重机制]`

---
### 破甲机制
武器属性中的 [武器穿透] 将影响玩家伤害的**破甲线**
当 (子弹命中目标的) [防御力]> (子弹来源者的) [穿透力] 时
子弹的伤害效能只能造成原有的**20%**

---
### 子弹射击
子弹射击分为4个阶段 开火阶段 生成阶段 飞行阶段 命中阶段
#### 流程图

```mermaid
graph TD;
    1(开火阶段);
    1 --> a{处于射击状态};
    a --> |是|退出开火;
    a --> |否|b{处于开火间隔};
    b --> |是|退出开火;
    b --> |否|2{处于连射状态};
    2 --> |是|标记'点射模式' --> 3;
    2 --> 3{判定武器类型};
    3 --> |霰弹|连射次数=1and弹片数量=子弹弹片 --> 4;
    3 --> |狙击|连射次数=1and弹片数量=1 --> 4;
    3 --> |通用|5[开火修正];
    5 --> |弹匣数量足够|连射次数=子弹连射and弹片数量=子弹弹片 -->4;
    5 --> |弹匣数量不足|根据弹匣内子弹数量子弹分配开火参数 -->4;
    4(生成阶段);
    4 -- 若有'点射模式'标记则后坐力仅有原本的20% --> 生成实体,分配属性,二分偏移,抖动计算等 --> 6;
    6(飞行阶段) --> 根据子弹速度向前位移/命中检测/穿墙检测/射程检测/飞行粒子 --检测到可命中目标 --> 7;
    7(命中阶段) --> 破甲机制/受击比例等伤害计算与扣血 --> 伤害提示 --> 8;
    8(结束);
    
```

---
### 负重机制
(暂未实装)
|装备以下道具时会增加当前身上的重量|
|--|
| 武器 |
| 防具 |
| 枪口 | 
| 握把 | 
| 弹匣 | 
| 枪托 | 
`此处 *[装备] 指的是数据化装备对应道具 *[携带] 不属于装备`

当 [玩家重量] > [玩家负重] 时 会根据超出的程度不同获得不同**DeBuff**
当 [玩家重量] < [一定数值] 时 会获得一些**额外增益**
